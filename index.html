<script src="jquery.js" type="text/javascript"></script>
<script src="jquery.speechify.js" type="text/javascript"></script><link rel="stylesheet" href="jquery.speechify.css" type="text/css" media="all" />
<script src="springy.js"></script><script src="springyui.js"></script>
<script src="springymap.js"></script>
<script src="springymap.htmlrenderer.js"></script>
<style>
#textrender {
	dbackground-color: lightgrey;
}
#textrender label {
	font-weight: bold;
	margin-left: 0em;
	font-size:1.5em;
}
#textrender .node {
	margin-top:0.5em;
	padding-bottom:1em;
}
#textrender .node .node {
	margin-left: 0.5em;
}
#textrender .node .node label{
	font-size:1.4em;
}
#textrender .node .node .node label{
	font-size:1.3em;
}
#textrender .node .node .node .node label {
	font-size:1.2em;
}
#textrender .node .node .node .node .node label {
	font-size:1.1em;
}
#textrender .node .node .node .node .node  label{
	font-size:1.0em;
}
#textrender .node .node .node .node .node label {
	font-size:0.9em;
}


#stextrender .node .node .node {
	margin-left: 1em;
}
#stextrender .node .node .node .node  {
	margin-left: 1.5em;
}
#stextrender .node .node .node .node .node  {
	margin-left: 2em;
}
#stextrender .node .node .node .node .node  {
	margin-left: 2.5em;
}

#textrender  .selectednode  {
	background-color: red !important;
}
#textrender  .editingnode > div.content {
	border: 2px solid blue !important;
}
.selectedtext {
	font-weight: bold;	
	background-color: lightblue;
	margin:0.1em;
	border-radius: 20px;
}

</style>
<body>
<div id="speechcontrols" ></div>

<div id="textrender" ></div>
<canvas id="springydemo" width="800" height="600" ></canvas>

<script>
// exposed for development, move inside jquery block for prod--
var graph = null;
// nodes, edges, nodeSet,
// getSelected(), setSelected(n), addNode(node), newNode(data), addEdge(e), addEdges([e]) new Springy.Node(), new Springy.Edge, findNode(label), findNodes(label), detachNode, removeNode(n), findEdges(from,to), removeEdge(e)
var renderer = null;
var renderAs='map';
//  graphChanged,
var springy = null;
var speechify = null;
var mapName = '';
$.fn.speechify.relPath='../';


jQuery(function(){
	graph = new Springy.Graph();
	renderer = SpringyMap.renderMapAs([1,{'$type':renderAs}]);
	SpringyMap.getMap();
	renderer.graphChanged();
	
	speechify = $("#speechcontrols").speechify({
		'grammarTree' : SpringyMap.grammarTree,
	});
	// click select bind body filter to labels with parent div.node
	$('body').bind('click',function(e) {
		var nodeDiv = $(e.target).parent();
		if (nodeDiv.hasClass('node')) {
			graph.setSelected(graph.nodeSet[$(nodeDiv).attr('id')]);
			renderer.graphChanged();
			e.stopImmediatePropagation();
		} else {
			graph.setSelected(null);
			renderer.graphChanged();
			e.stopImmediatePropagation();
		}
	});
});


</script>
</body>
