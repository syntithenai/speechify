<script src="jquery.js" type="text/javascript"></script>
<script src="jquery.speechify.js" type="text/javascript"></script><link rel="stylesheet" href="jquery.speechify.css" type="text/css" media="all" />
<script src="springy.js"></script><script src="springyui.js"></script>
<script src="springymap.js"></script>
<script src="springymap.htmlrenderer.js"></script>
<style>
#textrender {
	background-color: lightgrey;
}
#textrender .node .node{
	text-indent: 1em;
}
#textrender .node .node .node{
	text-indent: 2em;
}
#textrender .node .node .node .node {
	text-indent: 3em;
}
#textrender .node .node .node .node .node {
	text-indent: 4em;
}
#textrender .node .node .node .node .node {
	
}
#textrender .node .node .node .node .node {
	
}
#textrender  .selectednode {
	background-color: red !important;
}
.selectedtext {
	color: green;	
}

</style>
<body>
<div id="speechcontrols" ></div>

<div id="textrender" ></div>
<canvas id="springydemo" width="800" height="600" ></canvas>

<script>
// exposed for development, move inside jquery block for prod--
var graph = null;
// nodes, edges, nodeSet,
// getSelected(), setSelected(n), addNode(node), newNode(data), addEdge(e), addEdges([e]) new Springy.Node(), new Springy.Edge, findNode(label), findNodes(label), detachNode, removeNode(n), findEdges(from,to), removeEdge(e)
var renderer = null;
//  graphChanged,
var springy = null;
var speechify = null;
var mapName = '';
$.fn.speechify.relPath='../';


jQuery(function(){
	graph = new Springy.Graph();
	//springy = jQuery('#springydemo').springy({
	//	graph: graph
	//});
	//renderer = springy.renderer;
	renderer = new HtmlRenderer();
	SpringyMap.getMap();	
	renderer.graphChanged();
	
	speechify = $("#speechcontrols").speechify({
		'grammarTree' : SpringyMap.grammarTree,
	});
	// click select bind body filter to labels with parent div.node
	$('body').bind('click',function(e) {
		var nodeDiv = $(e.target).parent();
		if (nodeDiv.hasClass('node')) {
			graph.setSelected(graph.nodeSet[$(nodeDiv).attr('id')]);
			renderer.graphChanged();
			e.stopImmediatePropagation();
		}
	});
});


</script>
</body>
