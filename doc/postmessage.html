<script>
function makeIt() {
	base64FileUrl='http://images2.fanpop.com/images/photos/5800000/happy-kitten-kittens-5890512-1600-1200.jpg';
	ifrm = document.createElement("IFRAME"); 
	ifrm.id='iframe';
	ifrm.addEventListener("message", function (event) { 
											console.log(event,event.origin);
											event.source.postMessage('holla back youngin!',event.origin);
										 }
										, false);
 
   ifrm.setAttribute("src", base64FileUrl); 
   document.body.appendChild(ifrm); 
   return ifrm;
}
makeIt();

window.addEventListener("message", function() {console.log(event.origin,event.src,event.data)}, false);


function signalIt(message) {
	var win = document.getElementById("iframe").contentWindow;
    win.postMessage(message,'https://127.0.0.1');
}
signalIt('gday');

/*
base64FileUrl='http://images2.fanpop.com/images/photos/5800000/happy-kitten-kittens-5890512-1600-1200.jpg';

ifrm = document.createElement("IFRAME"); 
		 ifrm.addEventListener("message", function (event) { 
											console.log(event,event.origin);
										 }
										, false);
 
   ifrm.setAttribute("src", base64FileUrl); 
   document.body.appendChild(ifrm); 
   
   window.postMessage("hello there!", "https://127.0.0.1");
   
   
   ################
   POPUP
   
// * In the popup's scripts, running on <http://example.org>:
 
// Called sometime after postMessage is called
function receiveMessage(event)
{
  // Do we trust the sender of this message?
  if (event.origin !== "http://example.com:8080")
    return;
 
  // event.source is window.opener
  // event.data is "hello there!"
 
  // Assuming you've verified the origin of the received message (which
  // you must do in any case), a convenient idiom for replying to a
  // message is to call postMessage on event.source and provide
  // event.origin as the targetOrigin.
  event.source.postMessage("hi there yourself!  the secret response " +
                           "is: rheeeeet!",
                           event.origin);
}
 
window.addEventListener("message", receiveMessage, false);

#################################
WINDOW A

// * In window A's scripts, with A being on <http://example.com:8080>:
 var popup = window.open(...popup details...);
 
// When the popup has fully loaded, if not blocked by a popup blocker:
 
// This does nothing, assuming the window hasn't changed its location.
popup.postMessage("The user is 'bob' and the password is 'secret'",
                  "https://secure.example.net");
 
// This will successfully queue a message to be sent to the popup, assuming
// the window hasn't changed its location.
popup.postMessage("hello there!", "http://example.org");
 
function receiveMessage(event)
{
  // Do we trust the sender of this message?  (might be
  // different from what we originally opened, for example).
  if (event.origin !== "http://example.org")
    return;
 
  // event.source is popup
  // event.data is "hi there yourself!  the secret response is: rheeeeet!"
}
window.addEventListener("message", receiveMessage, false);
*/
</script>